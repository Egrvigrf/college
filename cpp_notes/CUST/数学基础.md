# 数学基础

数学基础：质数、约数、gcd、逆元、筛法、简单组合数、概率期望、exgcd

## 素数

素数筛

```c++
bool isPrime[100000010];
int Prime[6000010], cnt = 0;
void GetPrime(int n)
{
	memset(isPrime, 1, sizeof(isPrime));
	isPrime[1] = 0;
	for(int i = 2; i <= n; i++){
		if(isPrime[i]) Prime[++cnt] = i; 
		for(int j = 1; j <= cnt && i*Prime[j] <= n; j++) {
			isPrime[i*Prime[j]] = 0;
			if(i % Prime[j] == 0) break;
		}
	}
}
int main(){
	int n, q;
	scanf("%d %d", &n, &q);
	GetPrime(n);
	while (q--){
		int k;
		scanf("%d", &k);
		printf("%d\n", Prime[k]);
	}
	return 0;
}
```

对于质因数的各种题目基本上都需用素数筛提取出素数，在通过素数去处理

x= a + b

x=a * b * c

## 约数

gcd 	lcm 

```c++
int gcd(int a,int b){
return b ? gcd(b,a % b) : a;
}
int lcm(int a,int b){
    return a/gcd(a,b)*b;
}
```

[P1170 兔八哥与猎人 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/P1170)

## 逆元

[逆元 —— 广义化的倒数 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/449221995)

### 方法一：扩展欧几里得（exgcd）

```c++
int exgcd(int a, int b, int& x, int& y) {
	if (b == 0) {
		x = 1, y = 0;
		return a;
	}
	int r = exgcd(b, a % b, x, y);
	int temp = y;
	y = x - (a / b) * y;
	x = temp;
	return r;
}
int main(){
    int a,b,x,y;
    cin>>a>>b;//求a关于b的逆元
    cout<<(exgcd(a,b,x,y)==1?((x%b+b)%b:-1)<<endl;  //-1表示不存在逆元
}
```

### 方法二：费马小定理 （需快速幂

前提是p为质数，否则不能用

根据费马小定理，当gcd(a,p)=1时，有a^(p-1)=1 (mod p)，即a*a^(p-2)=1 (mod p)，即a关于p的逆元为a^(p-2)，用快速幂即可求。

```c++
# 快速幂
int q_pow(int a,int b,int mod)
{
    int res=1;
    while(b){
        if(b&1) res=res*a%mod;
        a=a*a%mod;
        b>>=1;
    }
    return res;
}
int main(){
    int a,p;
    cin>>a>>p;
 	int	ans=q_pow(a,p-2,p)   
}
```

## 简单组合数、概率期望

基本上都是根据题目结合排列公式，组合公式去计算，重点在于推导计算

[如何通俗的解释排列公式和组合公式的含义？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/26094736)

排列公式

![](https://picx.zhimg.com/80/v2-df59c896099d97643b4de42e49fbecac_720w.webp?source=1def8aca)



组合公式

![](https://pic1.zhimg.com/80/v2-853e0bfe98b2bcbd06360d8075799884_720w.webp?source=1def8aca)

一些性质：

![image-20240127184642796](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240127184642796.png)

![image-20240127184828630](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240127184828630.png)

![image-20240127184845001](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240127184845001.png)

全错位公式：

![image-20240127190032417](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240127190032417.png)



情况根据题目不同而不同，无固定模板

但注意当答案过大时，题目会要求取模

## 模下的除法 （费马小定理，exgcd，逆元

a/b=a*(1/b)

### 方法一

要在模下除以一个数，就等于乘上这个数逆元 也就是的这个数的（mod-2）次方 

![image-20240126144546699](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240126144546699.png)

### 方法二

![image-20240126144743705](C:\Users\洪劲雄\AppData\Roaming\Typora\typora-user-images\image-20240126144743705.png)

[AquaMoon and Chess - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/CF1545B)

